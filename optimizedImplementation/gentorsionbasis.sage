p = 10354717741769305252977768237866805321427389645549071170116189679054678940682478846502882896561066713624553211618840202385203911976522554393044160468771151816976706840078913334358399730952774926980235086850991501872665651576831

K.<i> = GF(p**2, name='i', modulus=x^2+1)

x = PolynomialRing(K, 'x').gen()

j = 2953399165407666434683263916327524575897143715665688585657512511376192736191588778608327497554337321145567982443207685975576081828357472177489977504060833673401016462765172308875363253294795781936916024981442215612291254297619 + 3175256156603708004681747787393450734992436055364293258961407110283377216134824903506204767001516171186387259590649955707640973006068375513830317744354590953183864811258764654721647915612022656131746468724747018378991291299406*i
a = 1
f = (x^4 + 216*a*x)^3 - j*a*((x^3-27*a)^3)
print(f.roots())
d = f.roots()[-1][0]
print("a = {}".format(a))
print("d = {}".format(d))


def genPoint(P):
	l = []
	while not l:
		px = randint(0, p) + randint(0, p)*i
		f = a*px^3 + x^3 + 1 - d*px*x
		l = f.roots()
	y = l[0][0]
	print("{}.X = {}".format(P, px))
	print("{}.Y = {}".format(P, y))

print()
genPoint("aliceP")
print()
genPoint("aliceQ")
print()
genPoint("bobP")
print()
genPoint("bobQ")
